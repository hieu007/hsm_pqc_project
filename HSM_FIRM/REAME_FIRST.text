D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n t√≠ch h·ª£p PQC (Kyber) v·ªõi HSM th√¥ng qua chu·∫©n PKCS#11, s·ª≠ d·ª•ng OpenSSL + Open Quantum Safe (liboqs) + pkcs11-provider.
‚úÖ M·ª§C TI√äU
- D√πng thu·∫≠t to√°n Kyber PQC (t·ª´ liboqs).
- Giao ti·∫øp v·ªõi HSM qua PKCS#11.
- S·ª≠ d·ª•ng OpenSSL ƒë·ªÉ th·ª±c hi·ªán c√°c thao t√°c m√£ h√≥a/k√Ω s·ªë h·∫≠u l∆∞·ª£ng t·ª≠.
| Th√†nh ph·∫ßn        | M·ª•c ƒë√≠ch                         |
| ----------------- | -------------------------------- |
| `liboqs`          | Cung c·∫•p thu·∫≠t to√°n Kyber PQC    |
| `oqs-openssl`     | M·ªü r·ªông OpenSSL ƒë·ªÉ h·ªó tr·ª£ PQC    |
| `pkcs11-provider` | K·∫øt n·ªëi PKCS#11 (HSM/SoftHSM)    |
| `SoftHSM`         | M√¥ ph·ªèng HSM (n·∫øu kh√¥ng c√≥ th·∫≠t) |

pqc-hsm-setup/
‚îú‚îÄ‚îÄ build_liboqs.sh
‚îú‚îÄ‚îÄ build_oqs_openssl.sh
‚îú‚îÄ‚îÄ setup_pkcs11_provider.sh
‚îú‚îÄ‚îÄ setup_softhsm.sh
‚îú‚îÄ‚îÄ test_pkcs11_with_pqc.sh
‚îî‚îÄ‚îÄ README.md


# pqc-hsm-setup

Thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng h·∫≠u l∆∞·ª£ng t·ª≠ (Post-Quantum Cryptography) v·ªõi h·ªó tr·ª£ PKCS#11 v√† HSM/SoftHSM, s·ª≠ d·ª•ng c√°c c√¥ng c·ª• t·ª´ Open Quantum Safe.

## üõ†Ô∏è C√¥ng c·ª• s·ª≠ d·ª•ng
- [liboqs](https://github.com/open-quantum-safe/liboqs): th∆∞ vi·ªán thu·∫≠t to√°n PQC
- [OQS-OpenSSL](https://github.com/open-quantum-safe/oqs-openssl): m·ªü r·ªông OpenSSL ƒë·ªÉ h·ªó tr·ª£ PQC
- [pkcs11-provider](https://github.com/latchset/pkcs11-provider): t√≠ch h·ª£p PKCS#11
- [SoftHSM2](https://github.com/opendnssec/SoftHSMv2): m√¥ ph·ªèng HSM cho ph√°t tri·ªÉn v√† test

## ‚öôÔ∏è C√†i ƒë·∫∑t

```bash
chmod +x *.sh

./build_liboqs.sh
./build_oqs_openssl.sh
./setup_pkcs11_provider.sh
./setup_softhsm.sh
./test_pkcs11_with_pqc.sh



B∆Ø·ªöC 1: C√†i ƒë·∫∑t liboqs + OQS-OpenSSL
# C√†i c√°c g√≥i c·∫ßn thi·∫øt
sudo apt update
sudo apt install cmake build-essential ninja-build libssl-dev

# Clone liboqs v√† build
git clone --recursive https://github.com/open-quantum-safe/liboqs.git
cd liboqs
mkdir build && cd build
cmake -GNinja .. -DOQS_USE_OPENSSL=ON -DBUILD_SHARED_LIBS=ON
ninja
sudo ninja install
# Clone v√† build OQS-OpenSSL (t√πy ch·ªânh OpenSSL h·ªó tr·ª£ PQC)
cd ~
git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/oqs-openssl.git
cd oqs-openssl
./Configure linux-x86_64 -lm
make -j$(nproc)
sudo make install
B∆Ø·ªöC 2: T√≠ch h·ª£p PKCS#11 qua pkcs11-provider
# Clone pkcs11-provider (n·∫øu d√πng HSM ho·∫∑c SoftHSM)
git clone https://github.com/latchset/pkcs11-provider.git
cd pkcs11-provider
meson build
ninja -C build
sudo ninja -C build install

C·∫•u h√¨nh pkcs11.conf (v√≠ d·ª• cho SoftHSM):
# T·∫°o file c·∫•u h√¨nh: /etc/pkcs11/pkcs11.conf
module = /usr/lib/softhsm/libsofthsm2.so

B∆Ø·ªöC 3: T·∫°o key PQC v√† ki·ªÉm tra
S·ª≠ d·ª•ng oqs-openssl ƒë·ªÉ t·∫°o c·∫∑p kh√≥a v·ªõi thu·∫≠t to√°n Kyber:
# T·∫°o kh√≥a c√¥ng khai/b√≠ m·∫≠t d√πng Kyber-512
openssl req -new -newkey oqsdefault -algorithm kyber512 -keyout kyber.key -out kyber.csr
# Thay kyber512 b·∫±ng kyber768 ho·∫∑c kyber1024 n·∫øu mu·ªën ƒë·ªô b·∫£o m·∫≠t cao h∆°n.
B∆Ø·ªöC 4: K·∫øt n·ªëi HSM qua PKCS#11
# C√†i v√† c·∫•u h√¨nh SoftHSM
sudo apt install softhsm2
softhsm2-util --init-token --slot 0 --label "PQC"
T·∫£i key PQC l√™n HSM (qua pkcs11-tool ho·∫∑c c√¥ng c·ª• qu·∫£n l√Ω HSM c·ªßa b·∫°n).
Ki·ªÉm tra ho·∫°t ƒë·ªông

# Li·ªát k√™ c√°c thu·∫≠t to√°n PQC ƒë∆∞·ª£c h·ªó tr·ª£:
openssl list -public-key-algorithms

# Giao ti·∫øp v·ªõi pkcs11-provider:
openssl req -engine pkcs11 -new -key <pkcs11-uri> -keyform engine -out pqc.csr
pkcs11:token=PQC;object=mykey;type=private
